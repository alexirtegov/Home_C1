/*
 * ex2.c
1. **–ü—Ä–æ—Å—Ç—ã–µ —Å–∏–º–≤–æ–ª—ã (–±–µ–∑ –¥–≤–æ–µ—Ç–æ—á–∏–π)**: 
   - `a`, `d`, `h` ‚Äî —ç—Ç–æ —Ñ–ª–∞–≥–∏. –û–Ω–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. 
   - –ü—Ä–∏–º–µ—Ä: `-a`, `-d`, `-h`.

2. **–°–∏–º–≤–æ–ª —Å –æ–¥–Ω–∏–º –¥–≤–æ–µ—Ç–æ—á–∏–µ–º (`:`) –ø–æ—Å–ª–µ –Ω–µ–≥–æ**:
   - `b:` ‚Äî –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–ø—Ü–∏—è `-b` —Ç—Ä–µ–±—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.
   - –ü—Ä–∏–º–µ—Ä: `-b value` –∏–ª–∏ `-bvalue`.
   - –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω, `getopt` –≤–µ—Ä–Ω–µ—Ç `?` (–æ—à–∏–±–∫—É).

3. **–°–∏–º–≤–æ–ª —Å –¥–≤—É–º—è –¥–≤–æ–µ—Ç–æ—á–∏—è–º–∏ (`::`) –ø–æ—Å–ª–µ –Ω–µ–≥–æ**:
   - `C::` ‚Äî –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–ø—Ü–∏—è `-C` –∏–º–µ–µ—Ç –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä.
   - –ü—Ä–∏–º–µ—Ä—ã:
     * `-C` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω, `optarg` –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `NULL`.
     * `-Cvalue` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä —É–∫–∞–∑–∞–Ω (–±–µ–∑ –ø—Ä–æ–±–µ–ª–∞), `optarg` –±—É–¥–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Å—Ç—Ä–æ–∫—É `"value"`.
   - –í–∞–∂–Ω–æ: –µ—Å–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å `-C value` (—Å –ø—Ä–æ–±–µ–ª–æ–º), —Ç–æ `value` –±—É–¥–µ—Ç –≤–æ—Å–ø—Ä–∏–Ω—è—Ç–æ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç (–Ω–µ –ø–∞—Ä–∞–º–µ—Ç—Ä), 
   –∏ —Ç–æ–≥–¥–∞ `optarg` –æ—Å—Ç–∞–Ω–µ—Ç—Å—è `NULL`, –∞ `value` –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–∞–∫ –Ω–æ–≤–∞—è –æ–ø—Ü–∏—è (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –æ–ø—Ü–∏—è) –∏–ª–∏ –∫–∞–∫ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç.

### –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ–ø—Ü–∏–∏ `b:` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä)
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
  - `./program -b hello` ‚Üí `optarg = "hello"`
  - `./program -bhello` ‚Üí `optarg = "hello"`
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
  - `./program -b` ‚Üí –æ—à–∏–±–∫–∞: `getopt` –≤–µ—Ä–Ω–µ—Ç `?`, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
  
 ### –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ–ø—Ü–∏–∏ `C::` (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä)
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
  - `./program -C` ‚Üí `optarg = NULL`
  - `./program -Cworld` ‚Üí `optarg = "world"`
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–æ –±–µ–∑ –æ—à–∏–±–∫–∏, –ø—Ä–æ—Å—Ç–æ –Ω–µ —Ç–∞–∫, –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è):
  - `./program -C world` ‚Üí `optarg = NULL`, –∞ `world` –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º 
  (–Ω–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –¥–ª—è `-C`). –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –∏–ª–∏ —Å–ª–µ–¥—É—é—â–∞—è –æ–ø—Ü–∏—è, –µ—Å–ª–∏ `world` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `-`.
  
### –ü–æ—á–µ–º—É —Ç–∞–∫ –≤–∞–∂–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–±–µ–ª–∞ –¥–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞?
–ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø—Ä–æ–±–µ–ª–∞–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ:
```bash
./program -C value
```
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤–∏–¥–∏—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: `"-C"` –∏ `"value"`. –ü–æ—Å–∫–æ–ª—å–∫—É –¥–ª—è `-C` –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π, `getopt` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `-C` 
(–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞) –∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç `"value"` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç). 
–ê –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∞—Å—Ç—å—é —Ç–æ–≥–æ –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: `"-Cvalue"`.

üß© –†–∞–∑–±–µ—Ä—ë–º –Ω–∞—à—É —Å—Ç—Ä–æ–∫—É "ab:C::dh":
–°–∏–º–≤–æ–ª	–¢–∏–ø –æ–ø—Ü–∏–∏	–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
a	–ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞	-a
b:	–° –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º	-b hello, -bworld
C::	–° –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º	-C, -C42
d	–ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞	-d
h	–ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞	-h
 */

#include <stdio.h>      // –î–ª—è —Ñ—É–Ω–∫—Ü–∏–π –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ (printf)
#include <unistd.h>     // –î–ª—è getopt() (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤)

int main(int argc, char *argv[])
{
    int rez = 0;  // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –æ–ø—Ü–∏–∏
    
    // –¶–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. "ab:C::dh" - —Å—Ç—Ä–æ–∫–∞ –æ–ø—Ü–∏–π:
    // a, d, h - —Ñ–ª–∞–≥–∏ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    // b: - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
    // C:: - –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
    while ((rez = getopt(argc, argv, "ab:C::dh")) != -1)
    {
        switch (rez)
        {
            case 'a': 
                printf("found argument \"a\".\n"); 
                break;
                
            case 'b': 
                printf("found argument \"b = %s\".\n", optarg); 
                break;
                
            case 'C': 
                printf("found argument \"C = %s\".\n", optarg); 
                break;
                
            case 'd': 
                printf("found argument \"d\"\n"); 
                break;
                
            case 'h':  // –ù–æ–≤–∞—è –æ–ø—Ü–∏—è –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
                printf("Usage: %s [OPTIONS]\n", argv[0]);
                printf("Options:\n");
                printf("  -a\t\tEnable feature A\n");
                printf("  -b VALUE\tSpecify value for B (required)\n");
                printf("  -C [VAL]\tOptional value for C\n");
                printf("  -d\t\tEnable debug mode\n");
                printf("  -h\t\tShow this help message\n");
                return 0;  // –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É –ø–æ—Å–ª–µ –≤—ã–≤–æ–¥–∞ —Å–ø—Ä–∞–≤–∫–∏
                
            case '?': 
                printf("Error: Unknown option or missing argument!\n");
                printf("Try '%s -h' for help.\n", argv[0]);
                return 1;  // –ó–∞–≤–µ—Ä—à–∞–µ–º —Å –æ—à–∏–±–∫–æ–π
        }
    }
    return 0;  // –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
}
